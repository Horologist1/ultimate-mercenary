<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Completo - Prueba 1</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e);
            color: #00ffff;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #00ffff;
            border-radius: 10px;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #ff0080;
            text-shadow: 0 0 10px #ff0080;
        }
        .context-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }
        .context-card {
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid #00ffff;
            border-radius: 8px;
            padding: 15px;
        }
        .context-title {
            font-size: 18px;
            font-weight: bold;
            color: #ff0080;
            margin-bottom: 10px;
        }
        .category-stats {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        .category-count {
            background: rgba(255, 0, 128, 0.2);
            border: 1px solid #ff0080;
            border-radius: 4px;
            padding: 5px 10px;
            font-size: 12px;
        }
        .test-button {
            background: linear-gradient(45deg, #ff0080, #00ffff);
            border: none;
            border-radius: 5px;
            color: white;
            padding: 8px 15px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
        }
        .test-button:hover {
            transform: scale(1.05);
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            border: 1px solid #00ffff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ PRUEBA 1 - VERIFICACI√ìN COMPLETA</h1>
        
        <div class="context-grid">
            <div class="context-card">
                <div class="context-title">üìÖ D√çA + RATING ALTO (>6)</div>
                <div class="category-stats" id="dia-alto-stats"></div>
                <button class="test-button" onclick="testContext('dia_alto')">Probar Contexto</button>
            </div>
            
            <div class="context-card">
                <div class="context-title">üìÖ D√çA + RATING BAJO (<6)</div>
                <div class="category-stats" id="dia-bajo-stats"></div>
                <button class="test-button" onclick="testContext('dia_bajo')">Probar Contexto</button>
            </div>
            
            <div class="context-card">
                <div class="context-title">üåô NOCHE + RATING ALTO (>6)</div>
                <div class="category-stats" id="noche-alto-stats"></div>
                <button class="test-button" onclick="testContext('noche_alto')">Probar Contexto</button>
            </div>
            
            <div class="context-card">
                <div class="context-title">üåô NOCHE + RATING BAJO (<6)</div>
                <div class="category-stats" id="noche-bajo-stats"></div>
                <button class="test-button" onclick="testContext('noche_bajo')">Probar Contexto</button>
            </div>
        </div>
        
        <div class="results" id="results">
            <h3>üìä Resultados del Test</h3>
            <p>Selecciona un contexto para ver los mensajes...</p>
        </div>
    </div>

    <script src="contextual-messages.js"></script>
    <script>
        // Establecer Prueba 1 por defecto
        localStorage.setItem('currentTest', 'prueba1');
        
        // Funci√≥n para contar mensajes por categor√≠a
        function countMessagesByCategory(messages) {
            const counts = {
                fan: 0,
                picante: 0,
                humillante: 0,
                relleno: 0,
                queja: 0,
                divertido: 0,
                insulto: 0
            };
            
            messages.forEach(msg => {
                if (msg && msg.category) {
                    counts[msg.category] = (counts[msg.category] || 0) + 1;
                }
            });
            
            return counts;
        }
        
        // Funci√≥n para mostrar estad√≠sticas de un contexto
        function showContextStats(contextKey, containerId) {
            const messages = CONTEXTUAL_MESSAGES.prueba1[contextKey] || [];
            const counts = countMessagesByCategory(messages);
            const container = document.getElementById(containerId);
            
            container.innerHTML = '';
            Object.entries(counts).forEach(([category, count]) => {
                const div = document.createElement('div');
                div.className = 'category-count';
                div.innerHTML = `${category.toUpperCase()}: ${count}`;
                container.appendChild(div);
            });
        }
        
        // Funci√≥n para probar un contexto espec√≠fico
        function testContext(contextKey) {
            // Configurar el contexto
            const [timeOfDay, rating] = contextKey.split('_');
            const ratingValue = rating === 'alto' ? 8 : 4;
            
            localStorage.setItem('timeOfDay', timeOfDay);
            localStorage.setItem('rating', ratingValue.toString());
            
            // Obtener mensajes
            const messages = getContextualMessages();
            
            // Contar por categor√≠as
            const rawMessages = CONTEXTUAL_MESSAGES.prueba1[contextKey] || [];
            const counts = countMessagesByCategory(rawMessages);
            
            // Mostrar resultados
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <h3>üìä Resultados para: ${contextKey.replace('_', ' ').toUpperCase()}</h3>
                <p><strong>Total de mensajes:</strong> ${messages.length}</p>
                <p><strong>Desglose por categor√≠as:</strong></p>
                <ul>
                    ${Object.entries(counts).map(([cat, count]) => 
                        `<li>${cat.toUpperCase()}: ${count} mensajes</li>`
                    ).join('')}
                </ul>
                <div style="margin-top: 15px;">
                    <h4>üìù Muestra de mensajes (primeros 10):</h4>
                    <ul>
                        ${messages.slice(0, 10).map(msg => `<li>${msg}</li>`).join('')}
                    </ul>
                </div>
            `;
        }
        
        // Funci√≥n para verificar completitud
        function checkCompleteness() {
            const contexts = ['dia_alto', 'dia_bajo', 'noche_alto', 'noche_bajo'];
            const requiredCounts = {
                fan: 100,
                relleno: 100,
                divertido: 100,
                picante: 40,
                humillante: 40,
                queja: 40,
                insulto: 40
            };
            
            let allComplete = true;
            let report = 'üîç REPORTE DE COMPLETITUD:\n\n';
            
            contexts.forEach(contextKey => {
                const messages = CONTEXTUAL_MESSAGES.prueba1[contextKey] || [];
                const counts = countMessagesByCategory(messages);
                
                report += `üìå ${contextKey.toUpperCase()}:\n`;
                Object.entries(requiredCounts).forEach(([category, required]) => {
                    const actual = counts[category] || 0;
                    const status = actual >= required ? '‚úÖ' : '‚ùå';
                    const percentage = Math.round((actual / required) * 100);
                    
                    report += `   ${category.toUpperCase()}: ${actual}/${required} (${percentage}%) ${status}\n`;
                    
                    if (actual < required) {
                        allComplete = false;
                    }
                });
                report += '\n';
            });
            
            report += `\nüéØ ESTADO GENERAL: ${allComplete ? '‚úÖ COMPLETO' : '‚ùå INCOMPLETO'}`;
            
            console.log(report);
            
            return allComplete;
        }
        
        // Inicializar al cargar la p√°gina
        window.addEventListener('load', () => {
            showContextStats('dia_alto', 'dia-alto-stats');
            showContextStats('dia_bajo', 'dia-bajo-stats');
            showContextStats('noche_alto', 'noche-alto-stats');
            showContextStats('noche_bajo', 'noche-bajo-stats');
            
            // Verificar completitud
            checkCompleteness();
        });
    </script>
</body>
</html> 