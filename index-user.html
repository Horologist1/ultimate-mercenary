<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Mercenary - Concursante</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="chat-publico.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
        }

        .main-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }

        .background-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
            opacity: 0.4;
            pointer-events: none;
            background-color: #000;
        }

        video#background-video {
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .ui-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .top-bar {
            background-color: rgba(0, 0, 0, 0.8);
            padding: 15px 15px 5px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #444;
            height: 140px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
            height: 100%;
            padding: 0;
        }

        .logo {
            height: 120px;
            transition: transform 0.3s ease;
            object-fit: contain;
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .title-container h1 {
            font-size: 24px;
            margin: 0;
            color: #00ccff;
        }

        .title-container h2 {
            font-size: 18px;
            margin: 0;
            color: #ff4757;
        }

        .main-area {
            flex: 1;
            display: flex;
            padding: 10px 20px;
            gap: 15px;
            height: calc(100vh - 90px);
            margin-top: 10px;
            overflow: hidden;
        }

        .chat-container {
            flex: 1.5;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 8px;
            border: 1px solid #444;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            max-height: calc(100vh - 110px);
            min-height: 0;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            min-height: 0;
            max-height: calc(100vh - 180px);
        }

        .chat-message {
            margin-bottom: 15px;
            padding: 10px;
            background-color: rgba(30, 30, 30, 0.8);
            border-radius: 4px;
            border: 1px solid #444;
            transition: all 0.3s ease;
        }

        .chat-message:hover {
            transform: translateX(5px);
        }

        .chat-message .username {
            color: #00ccff;
            font-weight: bold;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chat-message .content {
            color: #fff;
        }

        .chat-message.system {
            background-color: rgba(255, 71, 87, 0.2);
            border-color: #ff4757;
        }

        .chat-message.highlight {
            background-color: rgba(0, 204, 255, 0.2);
            border-color: #00ccff;
            animation: pulse 2s infinite;
        }

        .chat-message .tag {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 3px;
            text-transform: uppercase;
            font-weight: bold;
        }

        .chat-message .tag.vip {
            background-color: #ffd700;
            color: #000;
        }

        .chat-message .tag.sponsored {
            background-color: #ff4757;
            color: #fff;
        }

        .chat-message .pm-button {
            display: inline-block;
            margin-left: 10px;
            padding: 2px 8px;
            background-color: #2ed573;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .chat-message .pm-button:hover {
            background-color: #7bed9f;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 204, 255, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0, 204, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 204, 255, 0); }
        }

        .chat-input-container {
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.9);
            border-top: 1px solid #444;
            display: flex;
            gap: 10px;
            flex-shrink: 0;
        }

        .chat-input {
            flex: 1;
            padding: 10px;
            background-color: rgba(30, 30, 30, 0.8);
            border: 1px solid #444;
            border-radius: 4px;
            color: white;
        }

        .chat-submit {
            background-color: #ff4757;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
        }

        .opacity-toggle {
            background-color: #00ccff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .opacity-toggle:hover {
            background-color: #00a3cc;
        }

        .chat-container.transparent {
            background-color: rgba(0, 0, 0, 0.4);
        }

        .sidebar {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            gap: 10px;
            max-width: 300px;
            margin-left: auto;
            height: 100%;
        }

        .sidebar-section {
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 8px;
            border: 1px solid #444;
            padding: 12px;
        }

        .sidebar-section h3 {
            color: #00ccff;
            margin: 0 0 15px 0;
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            padding: 8px;
            background-color: rgba(30, 30, 30, 0.8);
            border-radius: 4px;
            border: 1px solid #444;
        }

        .stat-icon {
            width: 24px;
            height: 24px;
        }

        .stat-info {
            flex: 1;
        }

        .stat-label {
            color: #00ccff;
            font-size: 12px;
        }

        .stat-value {
            color: #ff4757;
            font-size: 18px;
            font-weight: bold;
        }

        .sidebar-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .sidebar-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px;
            background-color: rgba(30, 30, 30, 0.8);
            border: 1px solid #444;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .sidebar-button:hover {
            background-color: rgba(255, 71, 87, 0.2);
            border-color: #ff4757;
        }

        .sidebar-button img {
            width: 24px;
            height: 24px;
        }

        .objective-display {
            background-color: rgba(30, 30, 30, 0.8);
            border-radius: 4px;
            border: 1px solid #444;
            padding: 10px 10px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #444;
            min-height: 170px;
        }

        .objective-display h4 {
            color: #ff4757;
            margin: 0 0 10px 0;
            font-family: 'Orbitron', sans-serif;
            font-size: 15px;
        }

        .objective-display p {
            color: #fff;
            margin: 0;
            font-size: 13px;
            line-height: 1.4;
        }

        .scanline {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(0, 0, 0, 0.1) 50%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 1000;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(
                circle at center,
                transparent 0%,
                rgba(0, 0, 0, 0.3) 100%
            );
            pointer-events: none;
            z-index: 999;
        }

        .rules-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            overflow-y: auto;
        }

        .rules-content {
            max-width: 800px;
            margin: 50px auto;
            padding: 30px;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 8px;
            border: 1px solid #444;
            color: white;
        }

        .rules-content h1 {
            color: #00ccff;
            text-align: center;
            margin-bottom: 30px;
        }

        .rules-content section {
            margin-bottom: 30px;
        }

        .rules-content h2 {
            color: #ff4757;
            margin-bottom: 15px;
        }

        .rules-content ul {
            list-style: none;
            padding: 0;
        }

        .rules-content li {
            margin-bottom: 10px;
            padding: 10px;
            background-color: rgba(30, 30, 30, 0.8);
            border-radius: 4px;
            border: 1px solid #444;
        }

        .accept-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background-color: #ff4757;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 30px;
            transition: background-color 0.3s;
        }

        .accept-btn:hover {
            background-color: #ff6b81;
        }

        .back-button {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background-color: rgba(255, 71, 87, 0.8);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            z-index: 1000;
        }

        .back-button:hover {
            background-color: rgba(255, 71, 87, 1);
        }

        .messages-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 2000;
        }

        .messages-content {
            max-width: 800px;
            margin: 50px auto;
            padding: 30px;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 8px;
            border: 1px solid #444;
            color: white;
        }

        .message-item {
            margin-bottom: 15px;
            padding: 15px;
            background-color: rgba(30, 30, 30, 0.8);
            border-radius: 4px;
            border: 1px solid #444;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .message-sender {
            color: #00ccff;
            font-weight: bold;
        }

        .message-time {
            color: #666;
            font-size: 12px;
        }

        .message-content {
            color: #fff;
            font-size: 14px;
            line-height: 1.4;
            white-space: pre-line;
        }

        .logout-button {
            background-color: rgba(255, 71, 87, 0.8);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            transition: all 0.3s ease;
            margin-right: 65px;
        }

        .logout-button:hover {
            background-color: rgba(255, 71, 87, 1);
            transform: translateY(-2px);
        }

        .current-objective {
            background-color: rgba(0, 0, 0, 0.8);
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #444;
        }

        .current-objective h3 {
            color: #ff4757;
            margin: 0 0 10px 0;
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
        }

        .current-objective p {
            color: #fff;
            margin: 0;
            font-size: 14px;
            line-height: 1.4;
        }

        .cyberpunk-quote {
            background-color: rgba(0, 0, 0, 0.8);
            border-left: 4px solid #ff4757;
            padding: 20px;
            margin: 20px 0;
            color: #00ccff;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1em;
            line-height: 1.6;
            text-shadow: 0 0 10px rgba(0, 204, 255, 0.5);
            position: relative;
            overflow: hidden;
        }

        .cyberpunk-quote::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent 0%, rgba(255, 71, 87, 0.1) 50%, transparent 100%);
            animation: scan 2s linear infinite;
        }

        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .messages-section {
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 8px;
            border: 1px solid #444;
            padding: 20px;
            margin-top: 20px;
        }

        .messages-section h3 {
            color: #00ccff;
            margin: 0 0 15px 0;
            font-family: 'Orbitron', sans-serif;
            font-size: 18px;
        }

        .messages-container {
            height: 300px;
            overflow-y: auto;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 4px;
            border: 1px solid #444;
        }

        .message-item {
            background-color: rgba(30, 30, 30, 0.8);
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 10px;
            border-left: 3px solid #00ccff;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .message-sender {
            color: #ff4757;
            font-weight: bold;
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
        }

        .message-time {
            color: #666;
            font-size: 12px;
        }

        .message-content {
            color: #fff;
            font-size: 14px;
            line-height: 1.4;
        }

        /* Estilos específicos para diferentes tipos de mensajes */
        .message-item[data-type="shop"] {
            border-left-color: #2ecc71;
        }

        .message-item[data-type="achievement"] {
            border-left-color: #f1c40f;
        }

        .message-item[data-type="warning"] {
            border-left-color: #e74c3c;
        }

        /* Estilos para el modal de mensajes directos */
        .messages-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
        }

        .tab-button {
            background-color: rgba(30, 30, 30, 0.8);
            border: 1px solid #444;
            border-radius: 4px;
            padding: 8px 15px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-button.active {
            background-color: #ff4757;
            border-color: #ff4757;
        }

        .messages-list {
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        .message-item {
            background-color: rgba(30, 30, 30, 0.8);
            border-radius: 4px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 3px solid #00ccff;
        }

        .message-item[data-type="system"] {
            border-left-color: #ff4757;
        }

        .message-item[data-type="shop"] {
            border-left-color: #2ecc71;
        }

        .message-item[data-type="achievement"] {
            border-left-color: #f1c40f;
        }

        .message-item[data-type="warning"] {
            border-left-color: #e74c3c;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .message-sender {
            color: #00ccff;
            font-weight: bold;
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
        }

        .message-time {
            color: #666;
            font-size: 12px;
        }

        .message-content {
            color: #fff;
            font-size: 14px;
            line-height: 1.4;
        }

        .message-image {
            width: 100%;
            max-width: 200px;
            margin: 10px 0;
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid #00ccff;
        }

        .message-image img {
            width: 100%;
            height: auto;
            display: block;
        }

        .message-actions {
            margin-top: 10px;
            text-align: right;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .delete-button {
            background-color: #ff4757;
            color: #fff;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .delete-button:hover {
            background-color: #ff6b81;
            transform: translateY(-2px);
        }

        .purchase-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: rgba(0, 0, 0, 0.95);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #00ccff;
            color: #00ccff;
            display: none;
            z-index: 9999;
            animation: slideIn 0.5s ease-out;
            box-shadow: 0 0 20px rgba(0, 204, 255, 0.3);
            min-width: 300px;
            font-family: 'Orbitron', sans-serif;
        }

        .purchase-message h4 {
            color: #ff4757;
            margin: 0 0 10px 0;
            font-size: 1.2em;
            text-transform: uppercase;
        }

        .purchase-message p {
            margin: 5px 0;
            font-size: 1.1em;
        }

        .purchase-message .warning {
            color: #ff4757;
            font-weight: bold;
            margin-top: 10px;
            font-size: 0.9em;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        .accept-button {
            background-color: #00ccff;
            color: #000;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .accept-button:hover {
            background-color: #00a3cc;
            transform: translateY(-2px);
        }

        .no-messages {
            text-align: center;
            color: #666;
            padding: 20px;
            font-style: italic;
        }

        /* Estilos para los botones de acción */
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .action-button {
            width: 100%;
            padding: 12px;
            background-color: #ff4757;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
            transition: all 0.3s ease;
        }

        .action-button:hover {
            background-color: #ff6b81;
            transform: translateY(-2px);
        }

        /* Estilos para el modal de estadísticas */
        .modal {
            display: block;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 2000;
        }

        .modal-content {
            position: relative;
            background-color: rgba(0, 0, 0, 0.95);
            margin: 50px auto;
            padding: 20px;
            width: 80%;
            max-width: 1000px;
            border-radius: 8px;
            border: 1px solid #444;
            box-shadow: 0 0 20px rgba(0, 204, 255, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #444;
        }

        .modal-header h2 {
            color: #00ccff;
            margin: 0;
            font-family: 'Orbitron', sans-serif;
            font-size: 24px;
        }

        .close-button {
            padding: 10px 20px !important;
            background-color: rgba(255, 71, 87, 0.8) !important;
            color: white !important;
            border: none !important;
            border-radius: 4px !important;
            cursor: pointer !important;
            font-family: 'Orbitron', sans-serif !important;
            font-weight: bold !important;
            font-size: 14px !important;
            transition: all 0.3s ease !important;
        }

        .close-button:hover {
            background-color: rgba(255, 71, 87, 1) !important;
            color: white !important;
            transform: translateY(-1px) !important;
        }

        .modal-body {
            background-color: rgba(30, 30, 30, 0.8);
            border-radius: 4px;
            padding: 20px;
            min-height: 600px;
        }

        /* Forzar visibilidad y z-index de los modales */
        #test-modal, .modal, .messages-modal {
            z-index: 3000 !important;
        }
        #test-modal[style*="display: block"], .modal[style*="display: block"] {
            display: block !important;
        }
    </style>
</head>
<body>
    <!-- Firebase App (the core Firebase SDK) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
        import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBVc1a4E4_y-YJZV5ZqFQzTr1T8Txe8TmQ",
            authDomain: "ultimatemercenary-1e212.firebaseapp.com",
            projectId: "ultimatemercenary-1e212",
            storageBucket: "ultimatemercenary-1e212.firebasestorage.app",
            messagingSenderId: "683730871364",
            appId: "1:683730871364:web:350aaf7a296ad34db28811",
            databaseURL: "https://ultimatemercenary-1e212-default-rtdb.firebaseio.com/"
        };
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Referencias
        const conocidosRef = ref(database, 'conocidosSeleccionados');
        const conocimientosRef = ref(database, 'conocimientosSeleccionados');
        const mensajesRef = ref(database, 'mensajes-directos');
        const currentTestRef = ref(database, 'currentTest');
        const nombresRef = ref(database, 'nombresConcursantes');
        const audienceRef = ref(database, 'audience');
        const ratingRef = ref(database, 'rating');
        const pmRef = ref(database, 'playerPM');
        const chatRef = ref(database, 'mensajes-publico-expanded');

        // Listeners de sincronización
        onValue(conocidosRef, (snapshot) => {
            const data = snapshot.val();
            if (data) {
                localStorage.setItem('conocidosSeleccionados', JSON.stringify(data));
                if (window.renderTarjetasSeleccionadas) window.renderTarjetasSeleccionadas();
            }
        });
        onValue(conocimientosRef, (snapshot) => {
            const data = snapshot.val();
            if (data) {
                localStorage.setItem('conocimientosSeleccionados', JSON.stringify(data));
                if (window.renderTarjetasSeleccionadas) window.renderTarjetasSeleccionadas();
            }
        });
        onValue(mensajesRef, (snapshot) => {
            const data = snapshot.val();
            if (data) {
                localStorage.setItem('mensajes-directos', JSON.stringify(data));
                if (window.loadDirectMessages) window.loadDirectMessages();
            }
        });
        onValue(currentTestRef, (snapshot) => {
            const data = snapshot.val();
            if (data) {
                localStorage.setItem('currentTest', data);
                if (window.updateObjective) window.updateObjective();
            }
        });
        onValue(nombresRef, (snapshot) => {
            const data = snapshot.val();
            if (data) {
                Object.entries(data).forEach(([numero, nombre]) => {
                    localStorage.setItem(`nombreConcursante_${numero}`, nombre);
                });
                if (window.renderTarjetasSeleccionadas) window.renderTarjetasSeleccionadas();
            }
        });
        onValue(audienceRef, (snapshot) => {
            const data = snapshot.val();
            if (data !== null) {
                localStorage.setItem('spectators', data);
                if (window.updateStatusPanel) window.updateStatusPanel();
                if (window.updateUserList) window.updateUserList();
            }
        });
        onValue(ratingRef, (snapshot) => {
            const data = snapshot.val();
            if (data !== null) {
                localStorage.setItem('rating', data);
                if (window.updateStatusPanel) window.updateStatusPanel();
                if (window.updateUserList) window.updateUserList();
            }
        });
        onValue(pmRef, (snapshot) => {
            const data = snapshot.val();
            if (data !== null) {
                localStorage.setItem('playerPM', data);
                if (window.updateStatusPanel) window.updateStatusPanel();
                if (window.updateUserList) window.updateUserList();
            }
        });
        onValue(chatRef, (snapshot) => {
            const data = snapshot.val();
            if (data) {
                localStorage.setItem('mensajes-publico-expanded', JSON.stringify(data));
                if (window.loadChatMessages) window.loadChatMessages();
            }
        });

        // Funciones para guardar en Firebase (si el usuario puede modificar)
        window.saveConcursanteName = function(numero, nombre) {
            const nombreRef = ref(database, `nombresConcursantes/${numero}`);
            set(nombreRef, nombre);
        };
        window.saveAudience = function(valor) { set(audienceRef, valor); };
        window.saveRating = function(valor) { set(ratingRef, valor); };
        window.savePM = function(valor) { set(pmRef, valor); };
        window.saveChat = function(arr) { set(chatRef, arr); };
        window.saveConocidosSeleccionados = function(arr) { set(conocidosRef, arr); };
        window.saveConocimientosSeleccionados = function(arr) { set(conocimientosRef, arr); };
        window.saveMensajesDirectos = function(arr) { set(mensajesRef, arr); };
        window.saveCurrentTest = function(valor) { set(currentTestRef, valor); };
    </script>
    <div class="main-container">
        <!-- Video de fondo -->
        <video id="background-video" class="background-video" autoplay loop muted playsinline>
            <source src="videos/prueba0.mp4" type="video/mp4">
        </video>
        
        <!-- Contenedor de la interfaz -->
        <div class="ui-container">
            <!-- Barra superior -->
            <div class="top-bar">
                <div class="logo-container">
                    <img src="images/oce_logo.png" alt="OmniCorp Entertainment Logo" class="logo">
                    <div class="title-container">
                        <h1>ULTIMATE MERCENARY</h1>
                        <h2>Concursante #13</h2>
                    </div>
                </div>
                <button class="logout-button" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> CERRAR SESIÓN
                </button>
            </div>
            
            <!-- Área principal -->
            <div class="main-area">
                <!-- Chat -->
                <div class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <!-- Los mensajes se añadirán dinámicamente -->
                    </div>
                    <div class="chat-input-container">
                        <input type="text" class="chat-input" id="chat-input" placeholder="Escribe un mensaje...">
                        <button class="chat-submit" id="chat-submit"><i class="fas fa-paper-plane"></i></button>
                        <button class="opacity-toggle" id="opacity-toggle" title="Alternar transparencia del chat">
                            <i class="fas fa-adjust"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Panel lateral -->
                <div class="sidebar">
                    <!-- Estadísticas -->
                    <div class="sidebar-section">
                        <h3>ESTADÍSTICAS</h3>
                        <div class="stat-item">
                            <div class="stat-info">
                                <div class="stat-label">Audiencia</div>
                                <div class="stat-value" id="audience-value">0</div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-info">
                                <div class="stat-label">Rating</div>
                                <div class="stat-value" id="rating-value">0.0</div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-info">
                                <div class="stat-label">PM</div>
                                <div class="stat-value" id="pm-value">0</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Botones -->
                    <div class="sidebar-section" style="margin-top:auto; margin-bottom:auto;">
                        <h3>ACCIONES</h3>
                        <div class="action-buttons">
                            <button class="action-button" onclick="openShop()">TIENDA</button>
                            <button class="action-button" onclick="openMessages()">MENSAJES</button>
                            <button class="action-button" onclick="openObjective()">OBJETIVO</button>
                            <button class="action-button" onclick="openStats()">ESTADÍSTICAS</button>
                        </div>
                    </div>
                    
                    <!-- Objetivo actual -->
                    <div class="sidebar-section" style="margin-top:auto; flex-grow:1; min-height:200px;">
                        <h3>OBJETIVO ACTUAL</h3>
                        <div class="objective-display" id="current-objective" style="font-size:13px; padding:10px;">
                            <h4 id="objective-title" style="font-size:15px;">Cargando...</h4>
                            <p id="objective-description" style="font-size:13px;">Cargando objetivo...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal de Mensajes Directos -->
        <div id="messages-modal" class="messages-modal">
            <div class="messages-content">
                <h2>MENSAJES DIRECTOS</h2>
                <div class="messages-tabs">
                    <button class="tab-button active" data-tab="inbox">Bandeja de Entrada</button>
                    <button class="tab-button" data-tab="system">Sistema</button>
                    <button class="tab-button" data-tab="shop">Tienda</button>
                </div>
                <div id="messages-list" class="messages-list">
                    <!-- Los mensajes se añadirán dinámicamente -->
                </div>
                <button class="accept-btn" onclick="document.getElementById('messages-modal').style.display='none'">CERRAR</button>
            </div>
        </div>

        <!-- Modal de Reglas -->
        <div id="rules-modal" class="rules-modal">
            <div class="rules-content">
                <h1>REGLAS DEL JUEGO</h1>
                
                <section>
                    <h2>BIENVENIDA</h2>
                    <p>¡Bienvenido, recluta, a ULTIMATE MERCENARY! Has sido seleccionado para participar en la última experiencia de entretenimiento de OmniCorp Entertainment. Este no es un juego cualquiera; es una prueba de supervivencia, astucia y determinación en las calles de una metrópolis cyberpunk.</p>
                </section>
                
                <section>
                    <h2>CONCEPTO BÁSICO</h2>
                    <p>Ultimate Mercenary es un reality show transmitido en directo donde tú, como participante, debes completar misiones peligrosas mientras eres seguido por drones de transmisión. Tu objetivo: sobrevivir, completar los objetivos y entretener a la audiencia para ganar rating, seguidores y PM.</p>
                </section>
                
                <section>
                    <h2>CONDICIONES DEL CONCURSO</h2>
                    
                    <h3>Reglas de Supervivencia</h3>
                    <div class="rules-box">
                        <ul>
                            <li><strong>No hay reglas fijas</strong> — Kaiser puede cambiarlas en cualquier momento para aumentar el drama.</li>
                            <li><strong>La eliminación es permanente</strong> — Fallar una prueba, ser asesinado por otros concursantes (en pruebas PvP), o tener "baja audiencia" (Kaiser puede decidir eliminar a alguien aburrido).</li>
                            <li><strong>Las pilas corticales son propiedad de OCE</strong> — Al morir, toda tecnología implantada pertenece a la corporación.</li>
                            <li><strong>No hay salida</strong> — Intentar escapar se considera una violación del contrato y conlleva "consecuencias extremas".</li>
                            <li><strong>El entretenimiento es prioritario</strong> — Un concursante que genere suficiente interés podría recibir "privilegios especiales".</li>
                        </ul>
                    </div>

                    <h3>Sobre las "Segundas Oportunidades"</h3>
                    <p>Excepcionalmente, un concursante eliminado pero muy entretenido podría ser resleeveado en una funda sintética barata con una deuda de PM masiva (una "segunda oportunidad" que es más bien una condena a servidumbre).</p>

                    <h3>Premio</h3>
                    <p>El ganador del concurso recibirá un cheque en blanco para implantes y tanto equipo como pueda cargar en sus brazos.</p>
                </section>
                
                <section>
                    <h2>DESCARGO DE RESPONSABILIDAD</h2>
                    <p>OmniCorp Entertainment no se hace responsable por daños físicos, psicológicos o materiales sufridos durante la participación en Ultimate Mercenary. Al participar, reconoces y aceptas todos los riesgos inherentes a las actividades propuestas.</p>
                </section>
                
                <section class="text-center">
                    <h3 class="glowing-text">¿ESTÁS LISTO PARA LA PRUEBA DEFINITIVA?</h3>
                    <p>Para continuar, debes aceptar estas reglas y firmar el contrato digital. Una vez dentro, no hay vuelta atrás. La ciudad te espera, mercenario. Demuestra tu valor.</p>
                    
                    <button id="accept-btn" class="accept-btn">ACEPTAR Y CONTINUAR</button>
                </section>
            </div>
        </div>
        
        <!-- Modal de Prueba -->
        <div id="test-modal" class="rules-modal">
            <div class="rules-content">
                <h1 id="test-title">PRUEBA</h1>
                <div class="test-image-container">
                    <img id="test-image" src="images/kaiser_intro_new.png" alt="Imagen de la prueba" style="width: 100%; max-height: 300px; object-fit: cover; margin: 20px 0; border-radius: 8px;">
                </div>
                <div id="test-description" class="test-description">
                    <!-- La descripción se cargará dinámicamente -->
                </div>
                <button class="accept-btn" onclick="document.getElementById('test-modal').style.display='none'">CERRAR</button>
            </div>
        </div>
        
        <div class="scanline"></div>
        <div class="overlay"></div>
    </div>

    <!-- Secciones de Conocidos y Conocimientos -->
    <div class="sheet-section">
        <h3>Conocidos</h3>
        <div id="conocidos-tarjetas" class="personajes-container"></div>
    </div>
    <div class="sheet-section">
        <h3>Conocimientos</h3>
        <div id="conocimientos-tarjetas" class="facciones-container"></div>
    </div>

    <script src="mensajes-publico.js"></script>
    <script src="js/stats-manager.js"></script>
    <script>
    // Exponer funciones de UI globalmente para los listeners de Firebase
    if (typeof updateStatusPanel === 'function') window.updateStatusPanel = updateStatusPanel;
    if (typeof updateObjective === 'function') window.updateObjective = updateObjective;
    if (typeof loadChatMessages === 'function') window.loadChatMessages = loadChatMessages;
    if (typeof renderTarjetasSeleccionadas === 'function') window.renderTarjetasSeleccionadas = renderTarjetasSeleccionadas;
    if (typeof loadDirectMessages === 'function') window.loadDirectMessages = loadDirectMessages;
    if (typeof updateUserList === 'function') window.updateUserList = updateUserList;
    </script>
    <script>
    function logout() {
        // Solo elimina claves de login (ajusta los nombres si usas otros)
        localStorage.removeItem('user');
        localStorage.removeItem('sessionToken');
        sessionStorage.clear();
        document.cookie.split(';').forEach(function(c) {
            document.cookie = c.replace(/^ +/, '').replace(/=.*/, '=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/');
        });
        window.location.replace('login.html');
    }
    window.logout = logout;
    function openStats() {
        const statsWindow = document.createElement('div');
        statsWindow.className = 'modal';
        statsWindow.innerHTML = `
            <div class="modal-content">
                <div class="modal-header">
                    <h2>ESTADÍSTICAS</h2>
                    <button class="close-button" onclick="this.parentElement.parentElement.parentElement.remove()">VOLVER</button>
                </div>
                <div class="modal-body">
                    <iframe src="character-sheet-modal.html" style="width: 100%; height: 600px; border: none;"></iframe>
                </div>
            </div>
        `;
        document.body.appendChild(statsWindow);
        window.fichaIframe = statsWindow.querySelector('iframe');
    }
    window.openStats = openStats;
    </script>
    <script>
    // --- MODALES Y FUNCIONES GLOBALES ---
    function openShop() {
        console.log('[DEBUG] openShop called');
        const shopWindow = document.createElement('div');
        shopWindow.className = 'modal';
        shopWindow.style.zIndex = 3000;
        shopWindow.innerHTML = `
            <div class="modal-content">
                <div class="modal-header">
                    <h2>TIENDA</h2>
                    <button class="close-button" onclick="this.parentElement.parentElement.parentElement.remove()">VOLVER</button>
                </div>
                <div class="modal-body">
                    <iframe src="tienda.html" style="width: 100%; height: 600px; border: none;"></iframe>
                </div>
            </div>
        `;
        document.body.appendChild(shopWindow);
        window.tiendaIframe = shopWindow.querySelector('iframe');
    }
    window.openShop = openShop;

    function openMessages() {
        document.getElementById('messages-modal').style.display = 'block';
        if (window.loadDirectMessages) window.loadDirectMessages();
    }
    window.openMessages = openMessages;

    function openObjective() {
        console.log('[DEBUG] openObjective called');
        if (window.showTestDescription) window.showTestDescription();
    }
    window.openObjective = openObjective;

    // Exponer funciones de UI globalmente para los listeners de Firebase
    if (typeof updateStatusPanel === 'function') window.updateStatusPanel = updateStatusPanel;
    if (typeof updateObjective === 'function') window.updateObjective = updateObjective;
    if (typeof loadChatMessages === 'function') window.loadChatMessages = loadChatMessages;
    if (typeof renderTarjetasSeleccionadas === 'function') window.renderTarjetasSeleccionadas = renderTarjetasSeleccionadas;
    if (typeof loadDirectMessages === 'function') window.loadDirectMessages = loadDirectMessages;
    if (typeof updateUserList === 'function') window.updateUserList = updateUserList;
    if (typeof showTestDescription === 'function') window.showTestDescription = showTestDescription;
    </script>
    <script>
    // Actualiza los valores de audiencia, rating y PM en el panel lateral
    function updateStatusPanel() {
        const audience = localStorage.getItem('spectators') || '0';
        const rating = localStorage.getItem('rating') || '0.0';
        const pm = localStorage.getItem('playerPM') || '0';
        if (document.getElementById('audience-value')) document.getElementById('audience-value').textContent = audience;
        if (document.getElementById('rating-value')) document.getElementById('rating-value').textContent = rating;
        if (document.getElementById('pm-value')) document.getElementById('pm-value').textContent = pm;
    }
    window.updateStatusPanel = updateStatusPanel;

    // Actualiza el objetivo actual en la barra lateral
    function updateObjective() {
        const testObjectives = {
            'prueba0': {
                title: 'Prueba 0: La Caída',
                desc: 'Supervivencia inicial en el hangar subterráneo. Los concursantes deben adaptarse al entorno, familiarizarse con el equipo básico y demostrar su capacidad para sobrevivir en condiciones adversas.'
            },
            'prueba1': {
                title: 'Prueba 1: Carrera de Obstáculos',
                desc: 'Completar la carrera de obstáculos industrial. Los concursantes deben superar una serie de desafíos físicos y mentales, demostrando su agilidad, resistencia y capacidad de adaptación.'
            },
            'prueba2': {
                title: 'Prueba 2: La Cosecha',
                desc: 'Recolectar plantas y materiales valiosos del Jardín Vertical. Los concursantes deben identificar, recolectar y preservar especímenes raros y peligrosos, demostrando su conocimiento y precisión.'
            },
            'prueba3': {
                title: 'Prueba 3: La Entrega',
                desc: 'Realizar entregas de paquetes en el distrito industrial. Los concursantes deben transportar cargamentos valiosos a través de zonas peligrosas, demostrando su sigilo y eficiencia.'
            }
        };
        const currentTest = localStorage.getItem('currentTest') || 'prueba0';
        const obj = testObjectives[currentTest] || testObjectives['prueba0'];
        if (document.getElementById('objective-title')) document.getElementById('objective-title').textContent = obj.title;
        if (document.getElementById('objective-description')) document.getElementById('objective-description').textContent = obj.desc;
    }
    window.updateObjective = updateObjective;

    // Renderiza las tarjetas de conocidos y conocimientos
    function renderTarjetasSeleccionadas() {
        // Conocidos
        const conocidos = JSON.parse(localStorage.getItem('conocidosSeleccionados') || '[]');
        const personajes = [
            { nombre: 'Auri', img: 'images/kira_initial.png', desc: 'Protagonista principal, adaptable y endeudada con los Dragones de Jade.' },
            { nombre: 'Boris "Goliath" Volkov', img: 'images/goliath.png', desc: 'El Tanque Ruso, ex-Spetsnaz, brutal y directo.' },
            { nombre: 'Silas "Glitch" Vance', img: 'images/silas_glitch.png', desc: 'Netrunner nervioso, ex-ingeniero de seguridad.' },
            { nombre: 'Raven (Mizuki Tanaka)', img: 'images/raven.png', desc: 'La Asesina Silenciosa, maestra del sigilo.' },
            { nombre: 'Chispa (Anya Sharma)', img: 'images/chispa_new.png', desc: 'La Mecánica Optimista, experta en cromo.' },
            { nombre: 'Marcus "Old Man" Thorne', img: 'images/old_man.png', desc: 'El Veterano Cínico, ex-corporativo.' },
            { nombre: 'Jinx', img: 'images/jinx_alt.png', desc: 'La Psicópata Impredecible, disfruta del caos.' },
            { nombre: 'Lin Mayfair', img: 'images/lin_mayfair_new.png', desc: 'La "Inocente" Endeudada, historia trágica.' },
            { nombre: 'Subject Omega', img: 'images/subject_omega.png', desc: 'El Misterioso, posible experimento de OCE.' },
            { nombre: 'Ekaterina "Echo" Petrov', img: 'images/cyber_sniper.png', desc: 'La Francotiradora Fantasma, precisión sobrehumana.' },
            { nombre: 'Dr. Felix "Compound" Reyes', img: 'images/cyber_chemist.png', desc: 'El Químico Clandestino, genio de drogas de combate.' },
            { nombre: 'Los Gemelos (Jin & Jun)', img: 'images/cyber_twins.png', desc: 'Los Sincronizados, mentes enlazadas.' },
            { nombre: 'Sofía "Viper" Nakamura', img: 'images/viper_blade.png', desc: 'La Samurái Callejera, busca venganza.' },
            { nombre: 'Alex "Phantom" Mercer', img: 'images/hacker_phantom.png', desc: 'El Fantasma de la Red, hacker legendario.' },
            { nombre: 'Marcus "Titan" Graves', img: 'images/titan_warrior.png', desc: 'El Soldado Aumentado, ex-super-soldado.' },
            { nombre: 'Faith "Oracle" Lee', img: 'images/faith_oracle.png', desc: 'La Tecno-Sacerdotisa, ex-profeta de la Singularidad.' },
            { nombre: 'Darius "Thunder Fist" Jackson', img: 'images/thunder_fist.png', desc: 'El Campeón de las Peleas Clandestinas.' },
            { nombre: 'Aria "Maven" Chen', img: 'images/maven_corporate.png', desc: 'La Ejecutiva Despiadada, ex-vicepresidenta de Nakamura-Daichi.' }
        ];
        const container = document.getElementById('conocidos-tarjetas');
        if (container) {
            container.innerHTML = conocidos.map(nombre => {
                const p = personajes.find(p => p.nombre === nombre);
                if (!p) return '';
                return `<div class="personaje-card"><img src="${p.img}" alt="${p.nombre}"><div class="personaje-nombre">${p.nombre}</div><div class="personaje-desc">${p.desc}</div></div>`;
            }).join('') || '<div style="color:#888;font-size:13px;">No conoces a nadie... todavía.</div>';
        }
        // Conocimientos
        const conocimientos = JSON.parse(localStorage.getItem('conocimientosSeleccionados') || '[]');
        const facciones = [
            { nombre: 'OmniCorp Entertainment (OCE)', img: 'images/oce_logo.png', desc: 'Conglomerado mediático global, operaciones negras y tecnología militar.' },
            { nombre: 'Colectivo Nexus-9', img: 'images/nexus9_logo.png', desc: 'Tecno-anarquistas, democratizan la tecnología de modificación corporal.' },
            { nombre: 'Chrome Dynasty', img: 'images/chrome_dynasty_logo.png', desc: 'Organización criminal de élite, obsesionados con el cromo.' },
            { nombre: 'Zaibatsu Nakamura-Daichi Corp', img: 'images/nakamura_daichi_logo.png', desc: 'Conglomerado de biotecnología, integración tecno-orgánica.' },
            { nombre: 'Huérfanos Digitales', img: 'images/huerfanos_digitales_emblema.png', desc: 'Tribu urbana, víctimas de la "muerte digital".' }
        ];
        const containerF = document.getElementById('conocimientos-tarjetas');
        if (containerF) {
            containerF.innerHTML = conocimientos.map(nombre => {
                const f = facciones.find(f => f.nombre === nombre);
                if (!f) return '';
                return `<div class="faccion-card"><img src="${f.img}" alt="${f.nombre}"><div class="faccion-nombre">${f.nombre}</div><div class="faccion-desc">${f.desc}</div></div>`;
            }).join('') || '<div style="color:#888;font-size:13px;">No tienes conocimientos... todavía.</div>';
        }
    }
    window.renderTarjetasSeleccionadas = renderTarjetasSeleccionadas;

    // Carga los mensajes directos en el modal
    function loadDirectMessages() {
        const mensajes = JSON.parse(localStorage.getItem('mensajes-directos') || '[]');
        const list = document.getElementById('messages-list');
        if (!list) return;
        list.innerHTML = mensajes.map(msg => `<div class="direct-message"><b>${msg.sender}:</b> ${msg.content} <span style="float:right;font-size:11px;color:#888;">${msg.time || ''}</span></div>`).join('') || '<div style="color:#888;font-size:13px;">No tienes mensajes directos.</div>';
    }
    window.loadDirectMessages = loadDirectMessages;

    // Carga los mensajes públicos en el chat
    window.loadChatMessages = function() {
        let mensajes = [];
        try {
            mensajes = JSON.parse(localStorage.getItem('mensajes-publico-expanded') || '[]');
            if (!Array.isArray(mensajes)) mensajes = [];
        } catch (e) {
            mensajes = [];
        }
        const chat = document.getElementById('chat-messages');
        if (!chat) return;
        if (mensajes.length === 0) {
            // Mensajes de ejemplo locales si el chat está vacío
            const nombresUsuarios = [
                "Neo_Kyoto_Fan42", "SamuraiStalker", "EdgerunnerGirl", "MercenaryCrazy", 
                "BloodMoney99", "ChromeHeart", "WiredNinja", "NeonShadow",
                "CyberSlice", "DeathMatch_Lover", "KatanaQueen", "StreetHunter22"
            ];
            const ejemplos = [
                "¡Vamos XIII, no decepciones a tus fans!",
                "¡Estoy apostando todo por ti, no me falles!",
                "Mira esos reflejos, ¡eres una máquina!",
                "Mi IA predictiva dice que no llegarás a la siguiente ronda, XIII...",
                "Acabo de apostar 5000 créditos a que sobrevives esta prueba",
                "OCE debería ponerte un reto REAL, XIII",
                "Ese cromo que llevas parece de segunda mano...",
                "¡Eres mi favorita desde el principio!",
                "Solo las débiles usan tanto equipo. Demuestra tu valor real.",
                "Por dios, alguien dé algo de equipo decente a la XIII"
            ];
            const ejemploMensajes = Array.from({length: 10}).map((_,i) => ({
                sender: nombresUsuarios[i % nombresUsuarios.length],
                content: ejemplos[i % ejemplos.length],
                time: new Date().toLocaleTimeString()
            }));
            chat.innerHTML = ejemploMensajes.map(msg =>
                `<div class=\"chat-message\"><span class=\"username\">${msg.sender}:</span> <span class=\"content\">${msg.content}</span> <span style=\"float:right;font-size:11px;color:#888;\">${msg.time}</span></div>`
            ).join('') + '<div style="color:#888;font-size:13px;">(Mensajes de ejemplo: el chat global está vacío)</div>';
        } else {
            chat.innerHTML = mensajes.map(msg => {
                // Compatibilidad flexible
                const sender = msg.sender || msg.user || 'SISTEMA';
                const content = msg.content || msg.text || '';
                const time = msg.time || '';
                return `<div class=\"chat-message\"><span class=\"username\">${sender}:</span> <span class=\"content\">${content}</span> <span style=\"float:right;font-size:11px;color:#888;\">${time}</span></div>`;
            }).join('');
        }
        chat.scrollTop = chat.scrollHeight;
    };
    </script>
    <script>
    function showTestDescription() {
        // Objetivos y descripciones
        const testObjectives = {
            'prueba0': {
                title: 'Prueba 0: La Caída',
                desc: 'Supervivencia inicial en el hangar subterráneo. Los concursantes deben adaptarse al entorno, familiarizarse con el equipo básico y demostrar su capacidad para sobrevivir en condiciones adversas.',
                img: 'images/kaiser_intro_new.png'
            },
            'prueba1': {
                title: 'Prueba 1: Carrera de Obstáculos',
                desc: 'Completar la carrera de obstáculos industrial. Los concursantes deben superar una serie de desafíos físicos y mentales, demostrando su agilidad, resistencia y capacidad de adaptación.',
                img: 'images/prueba1.png'
            },
            'prueba2': {
                title: 'Prueba 2: La Cosecha',
                desc: 'Recolectar plantas y materiales valiosos del Jardín Vertical. Los concursantes deben identificar, recolectar y preservar especímenes raros y peligrosos, demostrando su conocimiento y precisión.',
                img: 'images/prueba2.png'
            },
            'prueba3': {
                title: 'Prueba 3: La Entrega',
                desc: 'Realizar entregas de paquetes en el distrito industrial. Los concursantes deben transportar cargamentos valiosos a través de zonas peligrosas, demostrando su sigilo y eficiencia.',
                img: 'images/prueba3.png'
            }
        };
        const currentTest = localStorage.getItem('currentTest') || 'prueba0';
        const obj = testObjectives[currentTest] || testObjectives['prueba0'];
        if (document.getElementById('test-title')) document.getElementById('test-title').textContent = obj.title;
        if (document.getElementById('test-description')) document.getElementById('test-description').textContent = obj.desc;
        if (document.getElementById('test-image')) document.getElementById('test-image').src = obj.img;
        if (document.getElementById('test-modal')) document.getElementById('test-modal').style.display = 'block';
    }
    window.showTestDescription = showTestDescription;
    </script>
</body>
</html> 